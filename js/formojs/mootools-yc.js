if(typeof FormoJS=="undefined"){FormoJS={}}FormoJS.Form=new Class({element:null,focus:null,fields:[],initialize:function(a){this.element=a;a.getElements("input[type!=submit]").each(function(c){var b=new FormoJS.Field(c);this.fields.push(b);c.addEvent("blur",this.field_blurred.bindWithEvent(this,[c,b]))},this)},field_blurred:function(b,c,a){a.validate()}});FormoJS.Field=new Class({element:null,initialize:function(a){this.element=a},get_block:function(){return this.element.getParent().getParent().getParent()},validate:function(){var c=this.get_block();var a=this;var b=new Request.JSON({url:FormoJS.validate_url+"field",onRequest:function(){c.removeClass("valid");c.removeClass("error");c.removeClass("server_error");c.addClass("validating")},onComplete:function(){c.removeClass("validating")},onFailure:function(){c.addClass("server_error");a.set_message(this.xhr.responseText)},onSuccess:function(e,d){if(e.status=="valid"){c.addClass("valid")}else{if(e.status=="invalid"){c.addClass("error")}else{c.addClass("server_error")}}a.set_message(e.message)}});b.setHeader("Referer",String(document.location));b.send({data:"field="+this.element.name+"&value="+this.element.value})},set_message:function(a){this.get_block().getElement(".error-message").set("html",a)}});window.addEvent("domready",function(){if(typeof FormoJS.validate_url=="undefined"){if(typeof console!="undefined"){console.log("Validation URL not configured.")}return}$$(".formo_form").each(function(a){new FormoJS.Form(a)})});